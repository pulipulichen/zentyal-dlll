package EBox::dlllciasrouter::Model::ManualNetworkIPRange;

use base 'EBox::Model::DataForm';

use strict;
use warnings;

use EBox::Global;
use EBox::Gettext;

use EBox::Types::Text;
use EBox::Types::MailAddress;


use Try::Tiny;

sub getOptions
{
    my $options = ();
    $options->{moduleName} = 'ManualNetworkIPRange';
    return $options;
}

# ------------------------------------------

sub new
{
    my ($class, %params) = @_;

    my $self = $class->SUPER::new(%params);
    bless($self, $class);

    return $self;
}

sub _table
{
    my ($self) = @_;

    my $options = $self->getOptions();

    my $lib = $self->parentModule()->model('LibraryToolkit');
    my $fieldsFactory = $self->loadLibrary('LibraryFields');

    my @fields = ();

    my $tableName = $options->{moduleName};

    my $desc = '+003C+0068+0031+003E+004E+0065+0074+0077+006F+0072+006B+0020+0049+0050+0020+0072+0061+006E+0067+0065+003C+002F+0068+0031+003E+000A+003C+0068+0031+003E+003C+0061+0020+0069+0064+003D+0022+0075+0073+0065+0072+002D+0063+006F+006E+0074+0065+006E+0074+002D+0076+0069+0072+0074+0075+0061+006C+002D+006D+0061+0063+0068+0069+006E+0065+0022+0020+0063+006C+0061+0073+0073+003D+0022+0061+006E+0063+0068+006F+0072+0022+0020+0068+0072+0065+0066+003D+0022+0068+0074+0074+0070+0073+003A+002F+002F+0067+0069+0074+0068+0075+0062+002E+0063+006F+006D+002F+0070+0075+006C+0069+0070+0075+006C+0069+0063+0068+0065+006E+002F+007A+0065+006E+0074+0079+0061+006C+002D+0064+006C+006C+006C+002F+0062+006C+006F+0062+002F+006D+0061+0073+0074+0065+0072+002F+0067+0075+0069+0064+0065+002F+0035+002D+0032+002D+006E+0065+0074+0077+006F+0072+006B+002D+0069+0070+002D+0072+0061+006E+0067+0065+002E+006D+0064+0023+0076+0069+0072+0074+0075+0061+006C+002D+006D+0061+0063+0068+0069+006E+0065+0022+003E+003C+002F+0061+003E+0056+0069+0072+0074+0075+0061+006C+0020+004D+0061+0063+0068+0069+006E+0065+003C+002F+0068+0031+003E+000A+003C+0068+0032+003E+003C+0061+0020+0069+0064+003D+0022+0075+0073+0065+0072+002D+0063+006F+006E+0074+0065+006E+0074+002D+0066+006F+0072+002D+0076+006D+0069+0064+002D+0031+0030+0030+0039+0039+0039+0022+0020+0063+006C+0061+0073+0073+003D+0022+0061+006E+0063+0068+006F+0072+0022+0020+0068+0072+0065+0066+003D+0022+0068+0074+0074+0070+0073+003A+002F+002F+0067+0069+0074+0068+0075+0062+002E+0063+006F+006D+002F+0070+0075+006C+0069+0070+0075+006C+0069+0063+0068+0065+006E+002F+007A+0065+006E+0074+0079+0061+006C+002D+0064+006C+006C+006C+002F+0062+006C+006F+0062+002F+006D+0061+0073+0074+0065+0072+002F+0067+0075+0069+0064+0065+002F+0035+002D+0032+002D+006E+0065+0074+0077+006F+0072+006B+002D+0069+0070+002D+0072+0061+006E+0067+0065+002E+006D+0064+0023+0066+006F+0072+002D+0076+006D+0069+0064+002D+0031+0030+0030+0039+0039+0039+0022+003E+003C+002F+0061+003E+0046+006F+0072+0020+0056+004D+0049+0044+003A+0020+0031+0030+0030+007E+0039+0039+0039+003C+002F+0068+0032+003E+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0045+0078+0061+006D+0070+006C+0065+0020+0056+004D+0049+0044+003A+0020+0031+0030+0035+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0045+0078+0061+006D+0070+006C+0065+0020+0049+0050+003A+0020+0031+0030+002E+0030+002E+0031+002E+0035+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0041+003A+0020+0031+0030+0020+0028+0066+0069+0078+0065+0064+0029+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0042+003A+0020+0030+0020+0028+0066+0069+0078+0065+0064+0029+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0043+003A+0020+0031+002C+0020+0031+007E+0039+0020+0028+0056+004D+0049+0044+0020+0031+006E+0064+0020+006E+0075+006D+0062+0065+0072+0029+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0044+003A+0020+0035+0020+0028+003D+0030+0035+0029+002C+0020+0031+007E+0039+0039+0020+0028+0056+004D+0049+0044+0020+0032+006E+0064+0020+0026+0061+006D+0070+003B+0020+0033+0072+0064+0020+006E+0075+006D+0062+0065+0072+0029+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+006F+0072+0074+0073+003A+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0050+006F+0075+006E+0064+003A+0020+0031+0030+0035+0030+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0048+0054+0054+0050+003A+0020+0031+0030+0035+0038+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0048+0054+0054+0050+0053+003A+0020+0031+0030+0035+0033+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0053+0053+0048+003A+0020+0031+0030+0035+0032+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0052+0044+0050+003A+0020+0031+0030+0035+0039+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+0068+0032+003E+003C+0061+0020+0069+0064+003D+0022+0075+0073+0065+0072+002D+0063+006F+006E+0074+0065+006E+0074+002D+0066+006F+0072+002D+0076+006D+0069+0064+002D+002D+0031+0030+0030+0030+0022+0020+0063+006C+0061+0073+0073+003D+0022+0061+006E+0063+0068+006F+0072+0022+0020+0068+0072+0065+0066+003D+0022+0068+0074+0074+0070+0073+003A+002F+002F+0067+0069+0074+0068+0075+0062+002E+0063+006F+006D+002F+0070+0075+006C+0069+0070+0075+006C+0069+0063+0068+0065+006E+002F+007A+0065+006E+0074+0079+0061+006C+002D+0064+006C+006C+006C+002F+0062+006C+006F+0062+002F+006D+0061+0073+0074+0065+0072+002F+0067+0075+0069+0064+0065+002F+0035+002D+0032+002D+006E+0065+0074+0077+006F+0072+006B+002D+0069+0070+002D+0072+0061+006E+0067+0065+002E+006D+0064+0023+0066+006F+0072+002D+0076+006D+0069+0064+002D+002D+0031+0030+0030+0030+0022+003E+003C+002F+0061+003E+0046+006F+0072+0020+0056+004D+0049+0044+003A+0020+0026+0067+0074+003B+0020+0031+0030+0030+0030+003C+002F+0068+0032+003E+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0045+0078+0061+006D+0070+006C+0065+0020+0056+004D+0049+0044+003A+0020+0031+0030+0035+0035+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0045+0078+0061+006D+0070+006C+0065+0020+0049+0050+003A+0020+0031+0030+002E+0031+002E+0030+002E+0035+0035+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0041+003A+0020+0031+0030+0020+0028+0066+0069+0078+0065+0064+0029+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0042+003A+0020+0031+002C+0020+0031+007E+0035+0020+0028+0056+004D+0049+0044+0020+0031+0073+0074+0020+006E+0075+006D+0062+0065+0072+0029+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0043+003A+0020+0030+0020+0028+0056+004D+0049+0044+0020+0032+006E+0064+0020+006E+0075+006D+0062+0065+0072+0029+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+0061+0072+0074+0020+0044+003A+0020+0035+0035+002C+0020+0031+007E+0039+0039+0020+0028+0056+004D+0049+0044+0020+0033+0072+0064+0020+0026+0061+006D+0070+003B+0020+0034+0074+0068+0020+006E+0075+006D+0062+0065+0072+0029+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0050+006F+0072+0074+0073+003A+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0050+006F+0075+006E+0064+003A+0020+0031+0030+0035+0035+0030+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0048+0054+0054+0050+003A+0020+0031+0030+0035+0035+0038+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0048+0054+0054+0050+0053+003A+0020+0031+0030+0035+0035+0033+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0053+0053+0048+003A+0020+0031+0030+0035+0035+0032+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0052+0044+0050+003A+0020+0031+0030+0035+0035+0039+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+0068+0032+003E+003C+0061+0020+0069+0064+003D+0022+0075+0073+0065+0072+002D+0063+006F+006E+0074+0065+006E+0074+002D+0064+0068+0063+0070+002D+0072+0061+006E+0067+0065+002D+0066+006F+0072+002D+0076+0069+0072+0074+0075+0061+006C+002D+006D+0061+0063+0068+0069+006E+0065+0073+0022+0020+0063+006C+0061+0073+0073+003D+0022+0061+006E+0063+0068+006F+0072+0022+0020+0068+0072+0065+0066+003D+0022+0068+0074+0074+0070+0073+003A+002F+002F+0067+0069+0074+0068+0075+0062+002E+0063+006F+006D+002F+0070+0075+006C+0069+0070+0075+006C+0069+0063+0068+0065+006E+002F+007A+0065+006E+0074+0079+0061+006C+002D+0064+006C+006C+006C+002F+0062+006C+006F+0062+002F+006D+0061+0073+0074+0065+0072+002F+0067+0075+0069+0064+0065+002F+0035+002D+0032+002D+006E+0065+0074+0077+006F+0072+006B+002D+0069+0070+002D+0072+0061+006E+0067+0065+002E+006D+0064+0023+0064+0068+0063+0070+002D+0072+0061+006E+0067+0065+002D+0066+006F+0072+002D+0076+0069+0072+0074+0075+0061+006C+002D+006D+0061+0063+0068+0069+006E+0065+0073+0022+003E+003C+002F+0061+003E+0044+0048+0043+0050+0020+0052+0061+006E+0067+0065+0020+0066+006F+0072+0020+0076+0069+0072+0074+0075+0061+006C+0020+006D+0061+0063+0068+0069+006E+0065+0073+003C+002F+0068+0032+003E+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0049+0050+0020+0072+0061+006E+0067+0065+003A+0020+0031+0030+002E+0036+002E+0032+002E+0031+0020+002D+0020+0031+0030+002E+0036+002E+0032+002E+0032+0035+0034+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+0070+003E+003C+0064+0065+006C+003E+0044+0048+0043+0050+0020+0066+006F+0072+0020+0074+0065+006D+0070+006F+0072+0061+0072+0079+0020+0076+0069+0072+0074+0075+0061+006C+0020+006D+0061+0063+0068+0069+006E+0065+0073+003A+0020+0031+0030+002E+0032+0035+0034+002E+0030+002E+0031+0020+002D+0020+0031+0030+002E+0032+0035+0034+002E+0032+0035+0035+002E+0032+0035+0034+003C+002F+0064+0065+006C+003E+003C+002F+0070+003E+000A+003C+0068+0072+0020+002F+003E+000A+003C+0068+0031+003E+003C+0061+0020+0069+0064+003D+0022+0075+0073+0065+0072+002D+0063+006F+006E+0074+0065+006E+0074+002D+0076+0069+0072+0074+0075+0061+006C+002D+0065+006E+0076+0069+0072+006F+006E+006D+0065+006E+0074+002D+0073+0065+0072+0076+0065+0072+002D+0070+0072+006F+0078+006D+006F+0078+0022+0020+0063+006C+0061+0073+0073+003D+0022+0061+006E+0063+0068+006F+0072+0022+0020+0068+0072+0065+0066+003D+0022+0068+0074+0074+0070+0073+003A+002F+002F+0067+0069+0074+0068+0075+0062+002E+0063+006F+006D+002F+0070+0075+006C+0069+0070+0075+006C+0069+0063+0068+0065+006E+002F+007A+0065+006E+0074+0079+0061+006C+002D+0064+006C+006C+006C+002F+0062+006C+006F+0062+002F+006D+0061+0073+0074+0065+0072+002F+0067+0075+0069+0064+0065+002F+0035+002D+0032+002D+006E+0065+0074+0077+006F+0072+006B+002D+0069+0070+002D+0072+0061+006E+0067+0065+002E+006D+0064+0023+0076+0069+0072+0074+0075+0061+006C+002D+0065+006E+0076+0069+0072+006F+006E+006D+0065+006E+0074+002D+0073+0065+0072+0076+0065+0072+002D+0070+0072+006F+0078+006D+006F+0078+0022+003E+003C+002F+0061+003E+0056+0069+0072+0074+0075+0061+006C+0020+0045+006E+0076+0069+0072+006F+006E+006D+0065+006E+0074+0020+0053+0065+0072+0076+0065+0072+0020+0028+0050+0072+006F+0078+006D+006F+0078+0029+003C+002F+0068+0031+003E+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0045+0078+0061+006D+0070+006C+0065+0020+0049+0050+003A+0020+0031+0030+002E+0036+002E+0030+002E+0035+0035+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0054+0068+0065+0020+0031+0073+0074+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0031+0030+002C+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0074+0068+0065+0020+0032+006E+0064+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0036+002C+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0074+0068+0065+0020+0033+0072+0064+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0030+002C+0020+0061+006E+0064+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0074+0068+0065+0020+0034+0074+0068+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0062+0065+0074+0077+0065+0065+006E+0020+0031+007E+0039+0039+002E+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0031+007E+0039+003A+0020+006D+0061+0073+0074+0065+0072+0020+0073+0065+0072+0069+0065+0073+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0031+0031+007E+0031+0039+003A+0020+0073+006C+0061+0076+0065+0020+0073+0065+0072+0069+0065+0073+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0032+0031+007E+0032+0039+003A+0020+0072+0061+0063+006B+0020+0073+0065+0072+0069+0065+0073+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E+000A+003C+0068+0031+003E+003C+0061+0020+0069+0064+003D+0022+0075+0073+0065+0072+002D+0063+006F+006E+0074+0065+006E+0074+002D+0073+0074+006F+0072+0061+0067+0065+002D+0073+0065+0072+0076+0065+0072+0073+0022+0020+0063+006C+0061+0073+0073+003D+0022+0061+006E+0063+0068+006F+0072+0022+0020+0068+0072+0065+0066+003D+0022+0068+0074+0074+0070+0073+003A+002F+002F+0067+0069+0074+0068+0075+0062+002E+0063+006F+006D+002F+0070+0075+006C+0069+0070+0075+006C+0069+0063+0068+0065+006E+002F+007A+0065+006E+0074+0079+0061+006C+002D+0064+006C+006C+006C+002F+0062+006C+006F+0062+002F+006D+0061+0073+0074+0065+0072+002F+0067+0075+0069+0064+0065+002F+0035+002D+0032+002D+006E+0065+0074+0077+006F+0072+006B+002D+0069+0070+002D+0072+0061+006E+0067+0065+002E+006D+0064+0023+0073+0074+006F+0072+0061+0067+0065+002D+0073+0065+0072+0076+0065+0072+0073+0022+003E+003C+002F+0061+003E+0053+0074+006F+0072+0061+0067+0065+0020+0053+0065+0072+0076+0065+0072+0073+003A+003C+002F+0068+0031+003E+000A+003C+0075+006C+003E+000A+003C+006C+0069+003E+0045+0078+0061+006D+0070+006C+0065+0020+0049+0050+003A+0020+0031+0030+002E+0036+002E+0031+002E+0034+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0054+0068+0065+0020+0031+0073+0074+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0031+0030+002C+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0074+0068+0065+0020+0032+006E+0064+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0036+002C+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0074+0068+0065+0020+0033+0072+0064+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0031+002C+0020+0061+006E+0064+003C+002F+006C+0069+003E+000A+003C+006C+0069+003E+0074+0068+0065+0020+0034+0074+0068+0020+0070+0061+0072+0074+0020+0073+0068+006F+0075+006C+0064+0020+0062+0065+0020+0062+0065+0074+0077+0065+0065+006E+0020+0031+007E+0039+0039+002E+003C+002F+006C+0069+003E+000A+003C+002F+0075+006C+003E';

    push(@fields, new EBox::Types::Text(
        'fieldName'  => 'content',
        'printableName' => __('Content'),
        'editable' => 0,
        'optional' => 0,
        'hiddenOnSetter' => 0,
        'hiddenOnViewer' => 1,
        'help' => $self->loadLibrary('LibraryFields')->createFieldDescriptionEditor(),
        'defaultValue' => $desc,
        'allowUnsafeChars' => 1,
    ));

    my $pageTitle = __('Network IP Range Manual');
 
    my $configView = '/dlllciasrouter/Composite/SettingComposite';
    my $dataTable =
        {
            'tableName' => $tableName,
            'pageTitle' => $pageTitle,
            'printableTableName' => $pageTitle,
            'modelDomain'     => 'dlllciasrouter',
            'defaultActions' => [ 'editField' ],
            'tableDescription' => \@fields,
            'HTTPUrlView'=> 'dlllciasrouter/View/' . $tableName,
            'messages' => {
                'update' => 'DONE <script type="text/javascript">location.href="'.$configView.'";</script>',
            }
        };

    return $dataTable;
}

# -------------------------------------------------------------

##
# 讀取指定的Model
sub loadLibrary
{
    my ($self, $library) = @_;
    return $self->parentModule()->model($library);
}

1;
